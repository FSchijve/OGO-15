%%%%%%%%%%%%%%%%%
% Neural_Sector %
%%%%%%%%%%%%%%%%%

% Vaststellen vaste waarden / parameters
% (DR) Curves 
% Functies
% Koppeling met andere systemen 

% Set values and parameters
CSF_Volume = 150                             % units: ml
Ref_Cort_Responsiveness_to_Ser = 0,8         % unitless
Ref_RelTime_Responsiveness_to_Ser = 5        % unitless
Ref_Ser_Responsiveness_to_Ser = 2            % unitless
Ref_Serotonin_Concentration_in_CSF = 3500    % units: pg/ml
Ref_TRP = 79                                 % units: micromole/liter
Ser_Smoothing_Time = 12                      % units: hour
Serotonin_Adj_Time = 0,5                     % units: hour
Serotonin_Mol_Weight = 176,215*1000          % units: pg/nmol
TRP_Ratio_Converted_into_Ser_in_CSF = 0,01   % unitless


% (DR) Curves
% Origin: DR Curve for Ser-Cortisol:
DR_Curve_for_Ser_Cortisol = (1.03*(x^5.63))/((1.04^5.63)+(x^5.63))
% Origin: DR Curve for Ser-RelTime:
DR_Curve_for_Ser_RelTime = (1*(x^2.95))/((0.54^2.95)+(x^2.95))
% Origin: DR Curve Serotonin-Serotonin: 
DR_Curve_for_Serotonin_Serotonin = 1/(1+exp(-3.79*(x-0.928)))

%ProCyt_Eff_on_TRP komt van Immune Sector
%De formule is benaderd door Origin van de getekende grafiek uit deze
%sector
ProCyt_Eff_on_TRP = -0.038 + ((1+0.038)/(x/5.45))


% Functions
Ref_Available_TRP = Ref_TRP*TRP_Ratio_Converted_into_Ser_in_CSF     % units: micromole/liter   

Available_TRP = Ref_Available_TRP*ProCyt_Eff_on_TRP;                % units: micromole/liter; ProCyt_Eff_on_TRP komt uit Immune sector                 
 
Cort_Response_to_Ser = Cort_Responsiveness_to_Ser*DR_Curve_for_Ser_Cortisol   % moet vermenigvuldigen met dx van curve -> forloop?

Cort_Responsiveness_to_Ser = Ref_Cort_Responsiveness_to_Ser*Avg_Serotonin_Eff_on_Responsiveness

TRP_Eff_on_Serotonin = 0.203 + (1.576-0.203)*x^4.465/ (0.528^4.465 + x^4.465)           % Benaderd met Origin

Serotonin_Capacity = Ref_Serotonin_Concentration_in_CSF*TRP_Eff_on_Serotonin_Capacity   % UNITS: pg/ml

Ser_Responsiveness_to_Ser = Ref_Ser_Responsiveness_to_Ser*Avg_Serotonin_Eff_on_Responsiveness

Ser_Response_to_Ser = DR_Curve_for_Serotonin_Serotonin*Ser_Responsiveness_to_Ser

Ser_Eff_on_Ser = Ser_Responsiveness_to_Ser-Ser_Response_to_Ser

Implied_Serotonin = Ref_Serotonin_Concentration_in_CSF*Ser_Eff_on_Ser           % UNITS: pg/ml
    
FuzzyMin_of_Serotonin = 1*x^2.60/(0.45^2.60+x^2.60)                             % Benaderd met Origin

Possible_Implied_Serotonin = FuzzyMin_of_Serotonin*Serotonin_Capacity           % UNITS: pg/ml
    
Ref_Serotonin_Mass_in_CSF = CSF_Volume*Ref_Serotonin_Concentration_in_CSF       % UNITS: pg
    
Ref_Serotonin_Vol_in_CSF = Ref_Serotonin_Mass_in_CSF/Serotonin_Mol_Weight       % UNITS: nmol
        
RelTime_Responsiveness_to_Ser = Avg_Serotonin_Eff_on_Responsiveness*Ref_RelTime_Responsiveness_to_Ser
    
RelTime_Response_to_Ser = DR_Curve_for_Ser_RelTime*RelTime_Responsiveness_to_Ser
    
Serotonin_Eff_on_Cortisol = Cort_Response_to_Ser
   
Serotonin_Eff_on_RelTime = (RelTime_Responsiveness_to_Ser-RelTime_Response_to_Ser)

Serotonin_Vol = CSF_Volume*Serotonin/Serotonin_Mol_Weight                       % UNITS: nmol

Serotonin_Eff_on_Responsiveness =  1/(1+exp(-3.79*(x-0.93)))                    % Benaderd door Origin
          
Shifted_Ref_Ser_for_PostR = Ref_Serotonin_Vol_in_CSF*Cort_Eff_on_PostReceptors  % UNITS: nmol

Shifted_Ref_Ser_for_PreR = Ref_Serotonin_Vol_in_CSF*Cort_Eff_on_PreReceptors    % UNITS: nmol

% Stocks
Avg_Serotonin_Eff_on_Responsiveness = Serotonin_Eff_on_Responsiveness
Ser_Eff_Smoothing = (Serotonin_Eff_on_Responsiveness - Avg_Serotonin_Eff_on_Responsiveness)/Ser_Smoothing_Time      % UNITS: 1/hour

Avg_Serotonin_Eff_on_Responsiveness(t) = Avg_Serotonin_Eff_on_Responsiveness(t - dt) + (Ser_Eff_Smoothing) * dt     % Avg(tijd - tijdsstap); Sef_Eff_(tijdsstap) 
            
            
            
Serotonin = Ref_Serotonin_Concentration_in_CSF                                     % UNITS: pg/ml           
Serotonin_Adjustment = (Possible_Implied_Serotonin - Serotonin)/Serotonin_Adj_Time   % UNITS: pg/ml/hour
%dSerotonin/dt=(Possible_Implied_Serotonin - Serotonin)/Serotonin_Adj_Time
 
Serotonin(t) = Serotonin(t - dt) + (Serotonin_Adjustment) * dt                     % Serotonin(tijd - tijdsstap); Serotonin_Adjustment * tijdsstap
